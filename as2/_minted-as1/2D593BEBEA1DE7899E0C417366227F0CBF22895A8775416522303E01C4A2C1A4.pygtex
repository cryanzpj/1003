\begin{Verbatim}[commandchars=\\\{\}]
\PYGdefault{n}{temp} \PYGdefault{o}{=} \PYGdefault{n}{Ridge\PYGdefaultZus{}lambda\PYGdefaultZus{}search}\PYGdefault{p}{(}\PYGdefault{n}{X\PYGdefaultZus{}train}\PYGdefault{p}{,}\PYGdefault{n}{y\PYGdefaultZus{}train}\PYGdefault{p}{[:,}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{],}\PYGdefault{n}{X\PYGdefaultZus{}validation}\PYGdefault{p}{,}\PYGdefault{n}{y\PYGdefaultZus{}validation}\PYGdefault{p}{[:,}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{],}
			\PYGdefault{n}{lambda\PYGdefaultZus{}} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{power}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{10}\PYGdefault{p}{,} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{linspace}\PYGdefault{p}{(}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{7}\PYGdefault{p}{,}\PYGdefault{l+m+mi}{6}\PYGdefault{p}{,}\PYGdefault{l+m+mi}{100}\PYGdefault{p}{)))[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]}
\PYGdefault{n}{lambda\PYGdefaultZus{}opt} \PYGdefault{o}{=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{power}\PYGdefault{p}{(}\PYGdefault{l+m+mi}{10}\PYGdefault{p}{,} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{linspace}\PYGdefault{p}{(}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{7}\PYGdefault{p}{,}\PYGdefault{l+m+mi}{6}\PYGdefault{p}{,}\PYGdefault{l+m+mi}{100}\PYGdefault{p}{))[}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{where}\PYGdefault{p}{(}\PYGdefault{n}{temp}  \PYGdefault{o}{==}\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{nanmin}\PYGdefault{p}{(}\PYGdefault{n}{temp}\PYGdefault{p}{))[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{][}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{]]}
\PYGdefault{n}{beta\PYGdefaultZus{}}\PYGdefault{o}{=} \PYGdefault{n}{regularized\PYGdefaultZus{}grad\PYGdefaultZus{}descent}\PYGdefault{p}{(}\PYGdefault{n}{X\PYGdefaultZus{}train}\PYGdefault{p}{,}\PYGdefault{n}{y\PYGdefaultZus{}train}\PYGdefault{p}{[:,}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{],}\PYGdefault{n}{lambda\PYGdefaultZus{}reg} \PYGdefault{o}{=} \PYGdefault{n}{lambda\PYGdefaultZus{}opt} \PYGdefault{p}{)[}\PYGdefault{l+m+mi}{0}\PYGdefault{p}{][}\PYGdefault{o}{\PYGdefaultZhy{}}\PYGdefault{l+m+mi}{1}\PYGdefault{p}{,:]}
\PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{sum}\PYGdefault{p}{(}\PYGdefault{n}{theta\PYGdefaultZus{}true}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{10}\PYGdefault{p}{:,:]} \PYGdefault{o}{!=} \PYGdefault{n}{np}\PYGdefault{o}{.}\PYGdefault{n}{array}\PYGdefault{p}{([}\PYGdefault{n}{beta\PYGdefaultZus{}}\PYGdefault{p}{])}\PYGdefault{o}{.}\PYGdefault{n}{T}\PYGdefault{p}{[}\PYGdefault{l+m+mi}{10}\PYGdefault{p}{:])}
\end{Verbatim}
